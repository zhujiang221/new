# å® ç‰©åŒ»é™¢ç®¡ç†ç³»ç»Ÿ - è‡ªåŠ¨åŒ–æµ‹è¯•æ–‡æ¡£

## ğŸ“‹ ç›®å½•ç»“æ„

```
e2e/
â”œâ”€â”€ tests/                    # æµ‹è¯•ç”¨ä¾‹ç›®å½•
â”‚   â”œâ”€â”€ auth.spec.ts         # è®¤è¯åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ user/                # ç”¨æˆ·è§’è‰²æµ‹è¯•
â”‚   â”‚   â””â”€â”€ user.spec.ts
â”‚   â”œâ”€â”€ doctor/              # åŒ»ç”Ÿè§’è‰²æµ‹è¯•
â”‚   â”‚   â””â”€â”€ doctor.spec.ts
â”‚   â””â”€â”€ admin/               # ç®¡ç†å‘˜è§’è‰²æµ‹è¯•
â”‚       â””â”€â”€ admin.spec.ts
â”œâ”€â”€ utils/                   # æµ‹è¯•å·¥å…·ç±»
â”‚   â”œâ”€â”€ auth.ts             # è®¤è¯å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ helpers.ts          # è¾…åŠ©å‡½æ•°
â”œâ”€â”€ generate-report.js       # æŠ¥å‘Šç”Ÿæˆè„šæœ¬
â””â”€â”€ README.md               # æœ¬æ–‡æ¡£
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å®‰è£…Playwrightæµè§ˆå™¨

```bash
npx playwright install
```

### 3. é…ç½®æµ‹è¯•è´¦å·

ç¼–è¾‘ `e2e/utils/auth.ts` æ–‡ä»¶ï¼Œé…ç½®æµ‹è¯•è´¦å·ä¿¡æ¯ï¼š

```typescript
export const TEST_USERS: Record<string, TestUser> = {
  admin: {
    username: 'admin',      // ä¿®æ”¹ä¸ºå®é™…çš„ç®¡ç†å‘˜è´¦å·
    password: '123456',      // ä¿®æ”¹ä¸ºå®é™…çš„å¯†ç 
    role: 'admin'
  },
  doctor: {
    username: 'doctor',      // ä¿®æ”¹ä¸ºå®é™…çš„åŒ»ç”Ÿè´¦å·
    password: '123456',      // ä¿®æ”¹ä¸ºå®é™…çš„å¯†ç 
    role: 'doctor'
  },
  user: {
    username: 'user',        // ä¿®æ”¹ä¸ºå®é™…çš„ç”¨æˆ·è´¦å·
    password: '123456',      // ä¿®æ”¹ä¸ºå®é™…çš„å¯†ç 
    role: 'user'
  }
};
```

### 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

ç¡®ä¿åç«¯å’Œå‰ç«¯æœåŠ¡éƒ½åœ¨è¿è¡Œï¼š

```bash
# å‰ç«¯ï¼ˆç«¯å£5173ï¼‰
npm run dev

# åç«¯ï¼ˆç«¯å£8186ï¼‰
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯å¯åŠ¨åç«¯æœåŠ¡
```

## ğŸ§ª è¿è¡Œæµ‹è¯•

### è¿è¡Œæ‰€æœ‰æµ‹è¯•

```bash
npm run test
```

### è¿è¡Œç‰¹å®šè§’è‰²çš„æµ‹è¯•

```bash
# åªè¿è¡Œè®¤è¯æµ‹è¯•
npm run test:auth

# åªè¿è¡Œç”¨æˆ·è§’è‰²æµ‹è¯•
npm run test:user

# åªè¿è¡ŒåŒ»ç”Ÿè§’è‰²æµ‹è¯•
npm run test:doctor

# åªè¿è¡Œç®¡ç†å‘˜è§’è‰²æµ‹è¯•
npm run test:admin
```

### è¿è¡Œæ‰€æœ‰æµ‹è¯•å¹¶ç”ŸæˆæŠ¥å‘Š

```bash
npm run test:all
```

### å…¶ä»–æµ‹è¯•é€‰é¡¹

```bash
# ä½¿ç”¨UIæ¨¡å¼è¿è¡Œï¼ˆå¯è§†åŒ–ï¼‰
npm run test:ui

# ä½¿ç”¨æœ‰å¤´æ¨¡å¼è¿è¡Œï¼ˆå¯ä»¥çœ‹åˆ°æµè§ˆå™¨ï¼‰
npm run test:headed

# è°ƒè¯•æ¨¡å¼
npm run test:debug
```

## ğŸ“Š æµ‹è¯•æŠ¥å‘Š

### æŸ¥çœ‹HTMLæŠ¥å‘Š

```bash
npm run test:report:open
```

### ç”Ÿæˆå®Œæ•´æŠ¥å‘Š

```bash
npm run test:report:generate
```

æŠ¥å‘Šæ–‡ä»¶ä½ç½®ï¼š
- **HTMLæŠ¥å‘Š**: `playwright-report/index.html`
- **JSONç»“æœ**: `test-results/results.json`
- **MarkdownæŠ¥å‘Š**: `test-results/report.md`
- **JUnit XML**: `test-results/junit.xml`
- **AllureæŠ¥å‘Š**: `allure-report/index.html` (å¦‚æœå®‰è£…äº†Allure)

## ğŸ“ æµ‹è¯•è¦†ç›–èŒƒå›´

### è®¤è¯åŠŸèƒ½æµ‹è¯• (`auth.spec.ts`)

- âœ… ç™»å½•é¡µé¢åŠ è½½
- âœ… ç®¡ç†å‘˜ç™»å½•
- âœ… åŒ»ç”Ÿç™»å½•
- âœ… ç”¨æˆ·ç™»å½•
- âœ… ç™»å½•å¤±è´¥åœºæ™¯ï¼ˆé”™è¯¯ç”¨æˆ·å/å¯†ç ï¼‰
- âœ… ç™»å‡ºåŠŸèƒ½
- âœ… æ³¨å†Œé¡µé¢è®¿é—®
- âœ… å¿˜è®°å¯†ç é¡µé¢è®¿é—®
- âœ… æœªç™»å½•è®¿é—®ä¿æŠ¤é¡µé¢é‡å®šå‘
- âœ… è§’è‰²æƒé™æ§åˆ¶

### ç”¨æˆ·è§’è‰²æµ‹è¯• (`user/user.spec.ts`)

- âœ… ç”¨æˆ·é¦–é¡µ
- âœ… å® ç‰©ç®¡ç†
- âœ… é¢„çº¦ç®¡ç†
- âœ… é¢„çº¦å°±è¯Šæµç¨‹
- âœ… å¥åº·æ ‡å‡†æŸ¥çœ‹
- âœ… å® ç‰©æ—¥å¿—
- âœ… å¥åº·æŒ‡å—
- âœ… è¯Šæ–­è®°å½•
- âœ… é¢„çº¦ç»Ÿè®¡
- âœ… æ—¥å¿—ç»Ÿè®¡
- âœ… å¥åº·è¯„ä¼°
- âœ… åŒ»ç”Ÿæ—¶é—´æŸ¥çœ‹
- âœ… ä¸ªäººä¿¡æ¯ç®¡ç†
- âœ… ä¿®æ”¹å¯†ç 
- âœ… æ›´å¤šåŠŸèƒ½
- âœ… æœç´¢åŠŸèƒ½
- âœ… åˆ†é¡µåŠŸèƒ½

### åŒ»ç”Ÿè§’è‰²æµ‹è¯• (`doctor/doctor.spec.ts`)

- âœ… åŒ»ç”Ÿé¦–é¡µ
- âœ… é¢„çº¦ç®¡ç†ï¼ˆæŸ¥çœ‹å’Œå¤„ç†ï¼‰
- âœ… å® ç‰©å¥åº·å²
- âœ… å® ç‰©æ—¥å¿—
- âœ… å¥åº·æŒ‡å—ç®¡ç†
- âœ… å¥åº·æ ‡å‡†ç®¡ç†
- âœ… é¢„çº¦ç»Ÿè®¡
- âœ… æ—¥å¿—ç»Ÿè®¡
- âœ… æ—¶é—´ç®¡ç†
- âœ… è¯å“ç®¡ç†
- âœ… å¼€è¯è®°å½•
- âœ… å¼€å…·è¯å“
- âœ… æ’ç­ç®¡ç†
- âœ… æœåŠ¡ç±»å‹ç®¡ç†
- âœ… æ¶ˆæ¯ä¸­å¿ƒ
- âœ… æ›´å¤šåŠŸèƒ½
- âœ… æœç´¢åŠŸèƒ½
- âœ… åˆ†é¡µåŠŸèƒ½

### ç®¡ç†å‘˜è§’è‰²æµ‹è¯• (`admin/admin.spec.ts`)

- âœ… ç®¡ç†å‘˜é¦–é¡µ
- âœ… ç”¨æˆ·ç®¡ç†
- âœ… é¢„çº¦ç±»å‹ç®¡ç†
- âœ… å® ç‰©ç®¡ç†
- âœ… è¯Šæ–­è®°å½•ç®¡ç†
- âœ… é¢„çº¦ç®¡ç†
- âœ… åŒ»ç”Ÿç©ºé—²æ—¶é—´
- âœ… æ’ç­ç®¡ç†
- âœ… æœåŠ¡ç±»å‹ç®¡ç†
- âœ… å¥åº·æŒ‡å—ç®¡ç†
- âœ… å¥åº·è¯„ä¼°
- âœ… å¥åº·æ ‡å‡†ç®¡ç†
- âœ… å® ç‰©æ—¥å¿—ç®¡ç†
- âœ… é¢„çº¦ç»Ÿè®¡
- âœ… æ—¥å¿—ç»Ÿè®¡
- âœ… è¯å“ç®¡ç†
- âœ… å¼€è¯è®°å½•ç®¡ç†
- âœ… æœç´¢åŠŸèƒ½
- âœ… åˆ†é¡µåŠŸèƒ½
- âœ… è·¨è§’è‰²è®¿é—®æƒé™

## ğŸ”§ æµ‹è¯•å·¥å…·å‡½æ•°

### è®¤è¯å·¥å…· (`utils/auth.ts`)

- `login(page, user)` - ç™»å½•åŠŸèƒ½
- `logout(page)` - ç™»å‡ºåŠŸèƒ½
- `isLoggedIn(page, expectedRole)` - æ£€æŸ¥ç™»å½•çŠ¶æ€
- `getCurrentUserRole(page)` - è·å–å½“å‰ç”¨æˆ·è§’è‰²

### è¾…åŠ©å‡½æ•° (`utils/helpers.ts`)

- `waitAndClick(page, selector)` - ç­‰å¾…å¹¶ç‚¹å‡»å…ƒç´ 
- `waitAndFill(page, selector, value)` - ç­‰å¾…å¹¶å¡«å†™è¡¨å•
- `waitForTableData(page)` - ç­‰å¾…è¡¨æ ¼æ•°æ®åŠ è½½
- `elementExists(page, selector)` - æ£€æŸ¥å…ƒç´ æ˜¯å¦å­˜åœ¨
- `pageContainsText(page, text)` - æ£€æŸ¥é¡µé¢æ˜¯å¦åŒ…å«æ–‡æœ¬
- `takeScreenshot(page, name)` - æˆªå›¾
- `fillForm(page, formData)` - å¡«å†™è¡¨å•
- `generateRandomString()` - ç”Ÿæˆéšæœºå­—ç¬¦ä¸²
- `generateRandomEmail()` - ç”Ÿæˆéšæœºé‚®ç®±
- `generateRandomPhone()` - ç”Ÿæˆéšæœºæ‰‹æœºå·

## âš™ï¸ é…ç½®è¯´æ˜

### Playwrighté…ç½® (`playwright.config.ts`)

- **åŸºç¡€URL**: `http://localhost:5173`
- **è¶…æ—¶è®¾ç½®**: 60ç§’
- **é‡è¯•æ¬¡æ•°**: CIç¯å¢ƒ2æ¬¡ï¼Œæœ¬åœ°0æ¬¡
- **æµè§ˆå™¨**: Chromiumï¼ˆå¯é…ç½®Firefoxå’ŒWebKitï¼‰
- **æˆªå›¾**: å¤±è´¥æ—¶è‡ªåŠ¨æˆªå›¾
- **è§†é¢‘**: å¤±è´¥é‡è¯•æ—¶å½•åˆ¶è§†é¢‘

### è‡ªå®šä¹‰é…ç½®

å¯ä»¥åœ¨ `playwright.config.ts` ä¸­ä¿®æ”¹ï¼š
- æµ‹è¯•è¶…æ—¶æ—¶é—´
- æµè§ˆå™¨ç±»å‹
- å¹¶è¡Œworkeræ•°é‡
- æŠ¥å‘Šæ ¼å¼

## ğŸ› è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹æµ‹è¯•æ‰§è¡Œè¿‡ç¨‹

```bash
npm run test:headed
```

### 2. ä½¿ç”¨UIæ¨¡å¼è°ƒè¯•

```bash
npm run test:ui
```

### 3. è°ƒè¯•ç‰¹å®šæµ‹è¯•

```bash
npm run test:debug -- e2e/tests/user/user.spec.ts
```

### 4. æŸ¥çœ‹å¤±è´¥æˆªå›¾

æµ‹è¯•å¤±è´¥æ—¶ï¼Œæˆªå›¾ä¼šè‡ªåŠ¨ä¿å­˜åœ¨ `test-results/` ç›®å½•ä¸‹ã€‚

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **æµ‹è¯•è´¦å·**: ç¡®ä¿æµ‹è¯•è´¦å·åœ¨æ•°æ®åº“ä¸­å­˜åœ¨ä¸”å¯†ç æ­£ç¡®
2. **éªŒè¯ç **: å¦‚æœç™»å½•éœ€è¦éªŒè¯ç ï¼Œå¯èƒ½éœ€è¦ï¼š
   - åœ¨æµ‹è¯•ç¯å¢ƒä¸­ç¦ç”¨éªŒè¯ç 
   - æˆ–ä½¿ç”¨æµ‹è¯•è´¦å·çš„ç‰¹æ®ŠéªŒè¯ç 
3. **æ•°æ®ä¾èµ–**: æŸäº›æµ‹è¯•å¯èƒ½éœ€è¦æ•°æ®åº“ä¸­æœ‰ç‰¹å®šæ•°æ®
4. **æœåŠ¡çŠ¶æ€**: ç¡®ä¿å‰åç«¯æœåŠ¡éƒ½åœ¨è¿è¡Œ
5. **ç½‘ç»œå»¶è¿Ÿ**: å¦‚æœç½‘ç»œè¾ƒæ…¢ï¼Œå¯èƒ½éœ€è¦å¢åŠ è¶…æ—¶æ—¶é—´

## ğŸ”„ CI/CDé›†æˆ

### GitHub Actionsç¤ºä¾‹

```yaml
name: E2E Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
        with:
          node-version: '18'
      - run: npm install
      - run: npx playwright install --with-deps
      - run: npm run test
      - uses: actions/upload-artifact@v3
        if: always()
        with:
          name: playwright-report
          path: playwright-report/
```

## ğŸ“ é—®é¢˜åé¦ˆ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æµ‹è¯•è´¦å·æ˜¯å¦æ­£ç¡®é…ç½®
2. å‰åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ
3. æµè§ˆå™¨æ˜¯å¦å·²å®‰è£…
4. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

## ğŸ“š æ›´å¤šèµ„æº

- [Playwrightæ–‡æ¡£](https://playwright.dev/)
- [Playwrightæœ€ä½³å®è·µ](https://playwright.dev/docs/best-practices)
- [æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹](playwright-report/index.html)
